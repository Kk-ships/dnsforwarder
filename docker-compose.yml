services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        TARGETOS: linux
        TARGETARCH: amd64
    ports:
      - "53:53/udp"
      - "8080:8080" # Optional: Expose metrics on port 8080
    env_file:
      - .env
    restart: always
    environment:
      - TZ=Asia/Kolkata
    # Run as root user if cache persistence or PID file management is needed
    user: nonroot
    volumes:
      - ./domain-routes/:/etc/dnsforwarder/domain-routes/:ro # Mount folder as read-only (recommended) # optional, required for custom domain routes
      # Add more folders/files as needed for custom domain routes
      - ./cache-data/:/app/cache/:rw # Mount cache persistence directory (Optional)

# For users who need interface binding features, use docker-compose.yml instead
# This configuration is more secure but doesn't support interface binding
